function editar(e){null!=e?Bookstarzz.ws.WSUsuarios.getOne(e,function(e){if(e){let a=JSON.parse(e);$("#txtNombre").val(a.Nombre),$("#txtApellidoP").val(a.ApellidoP),$("#txtApellidoM").val(a.ApellidoM),$("#txtEmail").val(a.Email),$("#txtUsuario").val(a.UsuarioN),$("#txtPass").val(a.Password),$("#txtConfirmar").val(a.Password),$("#txtTel").val(a.Telefono)}else $("#contenidoVista").load("FrmListaUsuarios.aspx")},function(e){$("#contenidoVista").load("FrmMenu.aspx",{typeError:"Libro no disponible"})}):window.location.replace("FrmLogin.aspx")}function agregar(){let e={};return e.Nombre=$("#txtNombre").val().trim(),e.ApellidoP=$("#txtApellidoP").val().trim(),e.ApellidoM=$("#txtApellidoM").val().trim(),e.UsuarioN=$("#txtUsuario").val().trim(),e.Email=$("#txtEmail").val().trim(),e.Password=$("#txtPass").val().trim(),e.Tipo=1,e.Telefono=$("#txtTel").val().trim(),JSON.stringify(e)}function modificar(e){let a=JSON.parse(e);return $("#txtNombre").val(a.Nombre),$("#txtApellidoP").val(a.ApellidoP),$("#txtApellidoM").val(a.ApellidoM),$("#txtUsuario").val(a.UsuarioN),$("#txtEmail").val(a.Email),$("#txtPass").val(a.Password),$("#txtConfirmar").val(a.Password),$("#txtTel").val(a.Telefono),JSON.stringify(a)}function limpiar(){$("#txtNombre").val(""),$("#txtApellidoP").val(""),$("#txtApellidoM").val(""),$("#txtUsuario").val(""),$("#txtEmail").val(""),$("#txtPass").val(""),$("#txtConfirmar").val(""),$("#txtTel").val("")}$(document).ready(function(){parseInt($("#txtSesion").val())>0||parseInt($("#txtEditar").val())>0?$("#BtnCancelar").click(function(){$("#contenidoVista").load("FrmListaUsuarios.aspx")}):$("#BtnCancelar").click(function(){window.location="FrmLogin.aspx"}),parseInt($("#txtEditar").val())>0&&editar(parseInt($("#txtEditar").val())),$("#BtnAgregar").click(function(){$("#FormMenu").data("bootstrapValidator").validate(),$("#FormMenu").data("bootstrapValidator").isValid()&&(parseInt($("#txtEditar").val())>0?Bookstarzz.ws.WSUsuarios.update(modificar(),function(e){1==e?$("#mdlModificar").modal("show"):($("#cntMsg").text("Error: no se ha podido realizar la operación"),$("#cntMsg").parent().show())},function(e){$("#cntMsg").text("Error: no se ha podido realizar la operación"),$("#cntMsg").parent().show()}):Bookstarzz.ws.WSUsuarios.insert(agregar(),function(e){if(parseInt(e)>0)limpiar(),$("#mdlConfirmar").modal("show");else{let a="",t=JSON.parse(e);""!=t.UsuarioN&&(a+="El campo Usuario agregado no esta disponible"),""!=t.Email&&(a+=", El campo email agregado no esta disponible"),""!=t.Telefono&&(a+=", El campo telefono agregado no esta disponible"),$("#cntMsg").text(a),$("#cntMsg").parent().show()}},function(e){$("#cntMsg").text("Error: no se ha podido realizar la operación"),$("#cntMsg").parent().show()}))}),$("#FormMenu").bootstrapValidator({framework:"bootstrap",excluded:[":disabled",":hidden"],fields:{txtNombre:{validators:{notEmpty:{message:"El Nombre no debe de estar vasio"},stringLength:{min:5,max:30,message:"El municipio debe de tener minimo 5 caracteres y maximo 30"}}},txtApellidoP:{validators:{notEmpty:{message:"El apellido paterno se requiere. no puede estar vasio"},stringLength:{min:5,max:30,message:"El apellido paterno debe de tener minimo 5 caracteres y maximo 30"}}},txtApellidoM:{validators:{notEmpty:{message:"El apellido materno se requiere. no puede estar vasio"},stringLength:{min:5,max:30,message:"El apellido materno debe de tener minimo 5 cacteres y maximo 30"}}},txtEmail:{validators:{notEmpty:{message:"El email se requiere. no puede estar vasio"},stringLength:{min:10,max:40,message:"El email debe de tener minimo 10 cacteres y maximo 40"}}},txtPass:{validators:{notEmpty:{message:"La contraseña se requiere. no puede estar vasio"},stringLength:{min:8,max:8,message:"La contraseña debe de tener 10 cacteres"}}},txtConfirmar:{validators:{notEmpty:{message:"La confirmacion se requiere. no puede estar vasio"},stringLength:{min:8,max:8,message:"La confirmacion debe de tener 8 caracteres"}}},txtUsuario:{validators:{notEmpty:{message:"El usuario se requiere. no puede estar vasio"},stringLength:{min:5,max:20,message:"El usuario debe de tener minimo 5 caracteres y maximo 20"}}},txtTelefono:{validators:{notEmpty:{message:"El telefono se requiere. no puede estar vasio"},stringLength:{min:10,max:10,message:"El telefono debe de tener 10 caracteres"}}}}})});