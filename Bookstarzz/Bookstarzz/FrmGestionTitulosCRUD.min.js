function validaURL(){1!=$("#txtURL").val()&&window.location.replace("FrmBookstarzz.aspx")}function mensaje(){const e=$("#txtInpMensaje").val();1==e&&($("#cntMsg").text("El libro se agregó con éxito"),$("#divMsg").addClass("alert-success"),$("#divMsg").css("display","block"),setTimeout(function(){$("#divMsg").css("display","none").fadeOut()},3e3)),2==e&&($("#tipoMsg").text("Error: "),$("#cntMsg").text("Verifica que la informacion introducida sea correcta y vuelve a intentarlo"),$("#divMsg").addClass("alert-danger"),$("#divMsg").css("display","block")),3==e&&($("#tipoMsg").text("Error: "),$("#cntMsg").text("Ha ocurrido un problema interno al intentar manipular/obtener la informacion"),$("#divMsg").addClass("alert-danger"),$("#divMsg").css("display","block"))}function limpiar(){$("#contenidoVista").empty()}function dateP(){$("#body_bloque_2_txtCalendario").datepicker({orientation:"top auto",format:"yyyy-mm-dd",language:"es",autoclose:!0,todayHighlight:!0})}function llenarModelo(){let e,o={};return parseInt($("#txtIdLibro").val())>0&&(o.IdLibro=$("#body_bloque_2_txtIDLib").val()),o.Nombre=$("#body_bloque_2_txtNombre").val(),o.Autor=$("#body_bloque_2_txtAutor").val(),o.NPaginas=$("#body_bloque_2_txtNumPaginas").val().trim(),"Niños"==$("#body_bloque_2_dropDownClasificacion").val()&&(e=1),"Adolecentes"==$("#body_bloque_2_dropDownClasificacion").val()&&(e=2),"Adultos"==$("#body_bloque_2_dropDownClasificacion").val()&&(e=3),o.Clasificacion=e,o.Editorial=$("#body_bloque_2_txtEditorial").val(),o.ISBN=$("#body_bloque_2_txtISBN").val().trim(),o.FechaPublicacion=$("#body_bloque_2_txtCalendario").val(),o.Presio=$("#body_bloque_2_txtPrecio").val(),o.Descripcion=$("#body_bloque_2_txtDescripcion").val(),JSON.stringify(o)}function llenarInterfaz(){const e=$("#txtIdLibro").val();e>0?($("#tituloFRM").text("MODIFICAR"),$("#body_bloque_2_lblIDLib").attr("hidden",!1),$("#body_bloque_2_txtIDLib").attr("hidden",!1),Bookstarzz.ws.WSLibros.getOne(e,llenarUI,function(e){$("#btnAceptar").attr("disabled",!0),window.scrollTo(0,0),$("#txtInpMensaje").val("3"),mensaje()})):$("#tituloFRM").text("AGREGAR")}function llenarUI(e){if(e){let o,t,a=JSON.parse(e);t=moment(a.FechaPublicacion).format("YYYY-MM-DD"),$("#body_bloque_2_txtIDLib").val(a.IdLibro),$("#body_bloque_2_txtNombre").val(a.Nombre),$("#body_bloque_2_txtAutor").val(a.Autor),$("#body_bloque_2_txtNumPaginas").val(a.NPaginas),1==a.Clasificacion&&(o="Niños"),2==a.Clasificacion&&(o="Adolecentes"),3==a.Clasificacion&&(o="Adultos"),$("#body_bloque_2_dropDownClasificacion").val(o),$("#body_bloque_2_txtEditorial").val(a.Editorial),$("#body_bloque_2_txtISBN").val(a.ISBN),$("#body_bloque_2_txtCalendario").val(t),$("#body_bloque_2_txtPrecio").val(a.Presio),$("#body_bloque_2_txtDescripcion").val(a.Descripcion)}else window.location.redirect("/")}function validacionBootsVal(){$("#formGestionTCRUD").bootstrapValidator({feedbackIcons:{valid:"glyphicon glyphicon-ok",invalid:"glyphicon glyphicon-remove",validating:"glyphicon glyphicon-refresh"},fields:{ctl00$body_bloque_2$txtNombre:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:2,max:50,message:"El elemento debe tener entre 2 y 50 caracteres"},regexp:{regexp:/^[a-zA-ZñÑ0-9\s]+$/,message:"El elemento debe contener caracteres alfanumericos"}}},ctl00$body_bloque_2$txtAutor:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:2,max:50,message:"El elemento debe tener entre 2 y 50 caracteres"},regexp:{regexp:/^[a-zA-ZñÑ0-9\s]+$/,message:"El elemento debe contener caracteres alfanumericos"}}},ctl00$body_bloque_2$txtNumPaginas:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:1,max:11,message:"El elemento debe tener entre 1 y 11 caracteres"},regexp:{regexp:/^[1-9][0-9]*$/,message:"El elemento debe contener solo caracteres numericos"}}},ctl00$body_bloque_2$txtEditorial:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:2,max:30,message:"El elemento debe tener entre 2 y 30 caracteres"},regexp:{regexp:/^[a-zA-ZñÑ0-9\s]+$/,message:"El elemento debe contener caracteres alfanumericos"}}},ctl00$body_bloque_2$txtISBN:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:2,max:30,message:"El elemento debe tener entre 2 y 30 caracteres"},regexp:{regexp:/^[a-zA-ZñÑ0-9]+$/,message:"El elemento debe contener caracteres alfanumericos. No se admiten espacios"}}},ctl00$body_bloque_2$txtCalendario:{validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},date:{format:"YYYY-MM-DD",message:"Fecha no válida"}}},ctl00$body_bloque_2$txtPrecio:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:1,max:10,message:"El elemento debe tener entre 1 y 10 caracteres"},regexp:{regexp:/^[0-9]+([.][0-9]+)?$/,message:"El elemento debe contener solo punto y caracteres numericos"}}},ctl00$body_bloque_2$txtDescripcion:{message:"El elemento no es valido",validators:{notEmpty:{message:"El elemento es requerido y no puede quedar vacio"},stringLength:{min:2,max:300,message:"El elemento debe tener entre 2 y 300 caracteres"},regexp:{regexp:/^[a-zA-ZñÑ0-9\s]+$/,message:"El elemento debe contener caracteres alfanumericos"}}}}})}$(document).ready(function(){validaURL(),$("#divBloque2").removeClass("col-10"),$("#divBloque1").removeClass("col-2 pr-0"),$("#divBloque2").addClass("container-fluid"),$("#divBloque1").addClass("col"),dateP(),llenarInterfaz(),mensaje(),$("#btnCancelar").click(function(){limpiar(),$("#contenidoVista").load("FrmGestionTitulos.aspx",{txtURL:1})}),$("#btnAceptar").click(function(){$("#formGestionTCRUD").data("bootstrapValidator").validate(),$("#formGestionTCRUD").data("bootstrapValidator").isValid()?parseInt($("#txtIdLibro").val())>0?Bookstarzz.ws.WSLibros.updateLibro(llenarModelo(),function(e){if(1==e){var o=$("#txtIdLibro").val();limpiar(),$("#contenidoVista").load("FrmGestionTitulos.aspx",{txtMsg:1,txtIdGlobal:o,txtURL:1})}else window.scrollTo(0,0),$("#txtInpMensaje").val("3"),mensaje()},function(e){}):Bookstarzz.ws.WSLibros.insertLibro(llenarModelo(),function(e){parseInt(e)>0?(limpiar(),$("#contenidoVista").load("FrmGestionTitulosCRUD.aspx",{txtInpMensaje:"1",txtURL:1})):(window.scrollTo(0,0),$("#txtInpMensaje").val("3"),mensaje())},function(e){}):(window.scrollTo(0,0),$("#txtInpMensaje").val("2"),mensaje())}),validacionBootsVal()});